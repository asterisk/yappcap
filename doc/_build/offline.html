

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Offline captures &mdash; yappcap 0.9.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="yappcap 0.9.0 documentation" href="index.html" />
    <link rel="prev" title="Live captures" href="live.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="live.html" title="Live captures"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">yappcap 0.9.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-yappcap">
<span id="offline-captures"></span><span id="offline"></span><h1>Offline captures<a class="headerlink" href="#module-yappcap" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="yappcap.PcapOffline">
<em class="property">class </em><tt class="descclassname">yappcap.</tt><tt class="descname">PcapOffline</tt><a class="headerlink" href="#yappcap.PcapOffline" title="Permalink to this definition">¶</a></dt>
<dd><p>PcapOffline(filename, autosave=None)</p>
<p>Pcap object for reading from a capture file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>filename (str): The filename of the capture file to process</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>autosave (str): The filename to pass to a PcapDumper object that will be used</dt>
<dd>to save any packet that is processed with dispatch() or next().</dd>
</dl>
</dd>
<dt>Raises:</dt>
<dd>PcapError</dd>
</dl>
<dl class="attribute">
<dt id="yappcap.PcapOffline.activated">
<tt class="descname">activated</tt><a class="headerlink" href="#yappcap.PcapOffline.activated" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not the capture has been activated (read/write)</p>
</dd></dl>

<dl class="attribute">
<dt id="yappcap.PcapOffline.datalink">
<tt class="descname">datalink</tt><a class="headerlink" href="#yappcap.PcapOffline.datalink" title="Permalink to this definition">¶</a></dt>
<dd><p>String representation of the datalink, i.e. &#8216;EN10MB&#8217; (read-only)</p>
<dl class="docutils">
<dt>Raises:</dt>
<dd>PcapError, PcapErrorNotActivated</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="yappcap.PcapOffline.dispatch">
<tt class="descname">dispatch</tt><big>(</big><em>self</em>, <em>count</em>, <em>callback</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#yappcap.PcapOffline.dispatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Process packets from a live capture or savefile</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">count (int): The maximum number of packets to return</p>
<p class="last">callback (function): A callback function accepting a PcapPacket, and optional args and kwargs</p>
</dd>
<dt>Returns:</dt>
<dd>int.  The number of packets returned.</dd>
<dt>Raises:</dt>
<dd>PcapErrorNotActivated, PcapError</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="yappcap.PcapOffline.filename">
<tt class="descname">filename</tt><a class="headerlink" href="#yappcap.PcapOffline.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>The filename of the capture file being processed (read-only)</p>
</dd></dl>

<dl class="attribute">
<dt id="yappcap.PcapOffline.filter">
<tt class="descname">filter</tt><a class="headerlink" href="#yappcap.PcapOffline.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter packets through a Berkeley Packet Filter (read/write)</p>
<p>The filter can be set either with a string describing a BPF filter,
e.g. &#8220;port 80&#8221;, or with a BpfProgram instance</p>
<dl class="docutils">
<dt>Raises:</dt>
<dd>PcapError, PcapErrorNotActivated</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="yappcap.PcapOffline.major_version">
<tt class="descname">major_version</tt><a class="headerlink" href="#yappcap.PcapOffline.major_version" title="Permalink to this definition">¶</a></dt>
<dd><p>The marjor version of the savefile format (read-only)</p>
</dd></dl>

<dl class="attribute">
<dt id="yappcap.PcapOffline.minor_version">
<tt class="descname">minor_version</tt><a class="headerlink" href="#yappcap.PcapOffline.minor_version" title="Permalink to this definition">¶</a></dt>
<dd><p>The minor version of the savefile format (read-only)</p>
</dd></dl>

<dl class="attribute">
<dt id="yappcap.PcapOffline.next">
<tt class="descname">next</tt><a class="headerlink" href="#yappcap.PcapOffline.next" title="Permalink to this definition">¶</a></dt>
<dd><p>x.next() -&gt; the next value, or raise StopIteration</p>
</dd></dl>

<dl class="attribute">
<dt id="yappcap.PcapOffline.snaplen">
<tt class="descname">snaplen</tt><a class="headerlink" href="#yappcap.PcapOffline.snaplen" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of bytes of each captured packet to store (read-only)</p>
</dd></dl>

<dl class="attribute">
<dt id="yappcap.PcapOffline.swapped">
<tt class="descname">swapped</tt><a class="headerlink" href="#yappcap.PcapOffline.swapped" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the savefile uses a different byte order than the current system (read-only)</p>
</dd></dl>

</dd></dl>

<div class="section" id="processing-an-offline-capture">
<h2>Processing an offline capture<a class="headerlink" href="#processing-an-offline-capture" title="Permalink to this headline">¶</a></h2>
<p>Processing saved capture files is very similar to processing live captures. The
properties listed above return information about the capture file, and
processing the packets is done with iterators, next(), and dispatch() as in
live captures.</p>
<p>As an example, the following will open a capture file and write only packets
that match port 5060 to the autosave file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">yappcap</span> <span class="kn">import</span> <span class="n">PcapOffline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">PcapOffline</span><span class="p">(</span><span class="s">&#39;/tmp/input.pcap&#39;</span><span class="p">,</span> <span class="n">autosave</span><span class="o">=</span><span class="s">&#39;/tmp/output.pcap&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="s">&#39;port 5060&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">pkt</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Offline captures</a><ul>
<li><a class="reference internal" href="#processing-an-offline-capture">Processing an offline capture</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="live.html"
                        title="previous chapter">Live captures</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/offline.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="live.html" title="Live captures"
             >previous</a> |</li>
        <li><a href="index.html">yappcap 0.9.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Terry Wilson.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>